<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Eventos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />
     <!-- Font Awesome -->
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
  <body class="container">
    <div class="container">
      <h1>Eventos</h1>
      <br />
      <div class="input-group">

        
        <div class="form-outline" data-mdb-input-init>
          <input type="search" placeholder="Procurar Evento" id="form1" class="form-control" />
        </div>
        <button type="button" class="btn btn-primary" ><i class="fas fa-search"></i></button>
      </div>
      <br />

      <div class="card text-center">
        <div class="card-header">
          <br />
        </div>
        <div class="card-body">
          <h5 class="card-title">Palestra Linux e distribuidores - Evento Sociedade Pinguim</h5>
          <p class="card-text text-muted">Rua Henrique Carmo, 38 - Vila Nova, Santos</p>
          <p class="card-text" style="color: coral;">HOJE | 14:00</p>
        </div>
        <div class="card-footer" style="color: coral;">HOJE</div>
      </div>
    </div>
  </body>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script>
    $(document).ready(function () {
      let submitBtn = document.getElementById('submitButton')
      $('#form_create_event').submit(function (e) {
        // Evitar o comportamento padrão do formulário de recarregar a página
        e.preventDefault()
    
        // Desabilitar o botão de envio
        submitBtn.disabled = true
    
        // Obter os valores dos campos
        let title = document.getElementById('title').value
        let description = document.getElementById('description').value
        let dtStartVal = document.getElementById('dtStart').value
        let hrStartVal = document.getElementById('hrStart').value
        let dtEndVal = document.getElementById('dtEnd').value
        let hrEndVal = document.getElementById('hrEnd').value
        let eventOnline = document.getElementById('eventOnline').checked
        let maximumAttendees = document.getElementById('maximumAttendees').value
        let location = document.getElementById('location').value
        let address = document.getElementById('address').value
        let zipcode = document.getElementById('zipcode').value
        let numberAddress = document.getElementById('numberAddress').value
        let city = document.getElementById('city').value
        let district = document.getElementById('district').value
    
        let dtStartFormatted = dtStartVal + ' ' + hrStartVal
        let dtEndFormatted = dtEndVal + ' ' + hrEndVal
    
        // Criar um objeto com os dados do formulário
        let formData = {
          title: title,
          details: description,
          start_date: dtStartFormatted,
          finish_date: dtEndFormatted,
          online: eventOnline,
          maximum_attendees: maximumAttendees,
          location: location,
          address: address,
          zipcode: zipcode,
          city: city,
          district: district
        }
    
        // Enviar os dados via AJAX para a rota /createEvent
        $.ajax({
          type: 'POST',
          url: '/events',
          data: JSON.stringify(formData),
          contentType: 'application/json',
          success: function (response) {
            // Reabilitar o botão de envio
            submitBtn.disabled = false
            // Lidar com a resposta da requisição (se necessário)
            console.log(response)
            alert('Evento criado com sucesso!')
            window.location.href = '/events'
          },
          error: function (response, desc, err) {
            // Reabilitar o botão de envio
            submitBtn.disabled = false
            console.log(response.responseJSON)
            console.log(response)
            console.log('Details: ' + desc + '\nError:' + err)
            alert('Erro ao criar o evento!')
            alert('Details0: ' + desc + '\nError:' + err)
          }
        })
      })
    })
  </script>
</html>
